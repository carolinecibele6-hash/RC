<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>R&C IPTV GOLD</title>
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        /* --- ESTILO GERAL (DARK/GOLD) --- */
        :root {
            --bg-color: #050505;
            --sidebar-bg: #111;
            --card-bg: #1a1a1a;
            --gold: #D4AF37;
            --gold-dim: #8a7020;
            --text-color: #ffffff;
        }

        * {
            box-sizing: border-box; /* Corrige calculos de tamanho */
        }

        body {
            margin: 0;
            padding: 0;
            background-color: var(--bg-color);
            color: var(--text-color);
            font-family: Arial, sans-serif; /* Fonte segura para TV antiga */
            overflow: hidden;
        }

        /* --- TELA DE LOGIN --- */
        #login-screen {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background: #000;
            z-index: 9999;
        }

        .login-box {
            background: #111;
            padding: 30px;
            border: 2px solid var(--gold-dim);
            width: 60%;
            max-width: 500px;
            text-align: center;
            border-radius: 8px;
        }

        .input-group { margin-bottom: 15px; text-align: left; }
        .input-label { color: var(--gold); display: block; margin-bottom: 5px; font-size: 16px; }
        .input-field {
            width: 100%; padding: 12px; background: #222; border: 1px solid #444; color: #fff; font-size: 18px;
        }

        .btn-gold {
            background: var(--gold);
            color: #000; border: none; padding: 15px; width: 100%; font-size: 18px; font-weight: bold; cursor: pointer; margin-top: 15px;
        }

        /* --- DASHBOARD PRINCIPAL --- */
        #main-dashboard {
            display: none;
            height: 100vh;
            width: 100vw;
            flex-direction: column;
            background-color: var(--bg-color);
        }

        /* HEADER COM INFORMA√á√ïES DA CONTA */
        .header {
            height: 90px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 30px;
            border-bottom: 2px solid var(--gold-dim);
            background: #0f0f0f;
            flex-shrink: 0;
        }

        .logo-area { font-size: 26px; font-weight: bold; color: var(--gold); width: 20%; }
        
        .account-info-bar {
            display: flex;
            gap: 20px;
            font-size: 14px;
            color: #ccc;
            background: #1a1a1a;
            padding: 10px 20px;
            border-radius: 5px;
            border: 1px solid #333;
        }
        
        .info-item span { color: var(--gold); font-weight: bold; margin-left: 5px; }

        /* --- HOME VIEW (√çcones Grandes) --- */
        #home-view {
            display: flex;
            width: 100%;
            height: 100%;
            justify-content: center;
            align-items: center;
            gap: 30px;
        }

        .big-card {
            width: 220px; height: 220px;
            background: #151515;
            border: 2px solid #333;
            border-radius: 10px;
            display: flex; flex-direction: column;
            justify-content: center; align-items: center;
        }

        /* --- LIST VIEW (Layout Corrigido) --- */
        #list-view {
            display: none;
            flex-direction: column;
            width: 100%;
            height: 100%;
        }

        /* Barra de Busca (Fica no topo da lista) */
        .search-container {
            height: 60px;
            background: #111;
            display: flex;
            align-items: center;
            padding: 0 20px;
            border-bottom: 1px solid #333;
        }
        
        .search-input {
            width: 100%;
            max-width: 600px;
            padding: 10px;
            background: #222;
            border: 1px solid #555;
            color: #fff;
            font-size: 18px;
        }

        /* √Årea Flex√≠vel: Menu Lateral + Grade */
        .content-body {
            flex: 1; /* Ocupa o resto da altura */
            display: flex;
            overflow: hidden; /* Importante para o scroll funcionar dentro */
        }

        .sidebar {
            width: 240px;
            background: var(--sidebar-bg);
            border-right: 1px solid #333;
            overflow-y: auto;
            flex-shrink: 0; /* N√£o deixa diminuir */
        }

        .menu-item {
            padding: 15px;
            border-bottom: 1px solid #222;
            color: #888;
            font-size: 16px;
        }
        .menu-item.active { background: #222; color: var(--gold); border-left: 5px solid var(--gold); }

        .grid-container {
            flex: 1; /* Ocupa a largura restante */
            padding: 20px;
            display: flex;
            flex-wrap: wrap; /* Permite quebra de linha */
            align-content: flex-start; /* Alinha itens no topo */
            overflow-y: auto;
            gap: 15px;
        }

        .card {
            width: 150px;
            height: 110px;
            background: #202020;
            border: 2px solid transparent;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
        }
        
        .card-name { font-size: 12px; margin-top: 5px; overflow: hidden; height: 30px; width: 90%; }

        /* FOCO */
        .focusable:focus, .focusable.focused {
            border-color: var(--gold) !important;
            background: #333 !important;
            transform: scale(1.05);
            outline: none;
            color: #fff !important;
            box-shadow: 0 0 10px rgba(212, 175, 55, 0.5);
            z-index: 10;
        }
        input.focusable:focus, input.focusable.focused { transform: none; background: #fff !important; color: #000 !important; }

        /* PLAYER */
        #player-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #000; display: none; z-index: 10000;
        }
        video { width: 100%; height: 100%; }

    </style>
</head>
<body>

    <section id="login-screen">
        <h1 style="color: var(--gold); font-size: 40px;">R&C GOLD</h1>
        <div class="login-box">
            <div class="input-group">
                <span class="input-label">Endere√ßo do Servidor</span>
                <input type="text" id="server" class="input-field focusable" placeholder="http://...">
            </div>
            <div class="input-group">
                <span class="input-label">Usu√°rio</span>
                <input type="text" id="user" class="input-field focusable" placeholder="Usu√°rio">
            </div>
            <div class="input-group">
                <span class="input-label">Senha</span>
                <input type="password" id="pass" class="input-field focusable" placeholder="Senha">
            </div>
            <button class="btn-gold focusable" onclick="doLogin()">ENTRAR</button>
        </div>
    </section>

    <section id="main-dashboard">
        <div class="header">
            <div class="logo-area">R&C IPTV</div>
            
            <div class="account-info-bar">
                <div class="info-item">Criado: <span id="info-created">--/--/--</span></div>
                <div style="border-right: 1px solid #444;"></div>
                <div class="info-item">Vencimento: <span id="info-expire">--/--/--</span></div>
                <div style="border-right: 1px solid #444;"></div>
                <div class="info-item">Telas: <span id="info-limit">0/0</span></div>
            </div>

            <div id="clock" style="font-size: 20px; font-weight: bold;">00:00</div>
        </div>

        <div id="home-view">
            <div class="big-card focusable" onclick="loadCategory('live')">
                <div style="font-size: 50px;">üì∫</div>
                <h3 style="color:#ccc;">TV AO VIVO</h3>
            </div>
            <div class="big-card focusable" onclick="loadCategory('movies')">
                <div style="font-size: 50px;">üé¨</div>
                <h3 style="color:#ccc;">FILMES</h3>
            </div>
            <div class="big-card focusable" onclick="loadCategory('series')">
                <div style="font-size: 50px;">üéûÔ∏è</div>
                <h3 style="color:#ccc;">S√âRIES</h3>
            </div>
        </div>

        <div id="list-view">
            <div class="search-container">
                <span style="margin-right: 10px; color: var(--gold);">üîç</span>
                <input type="text" id="internal-search" class="search-input focusable" placeholder="Digite o nome do canal ou filme..." onkeyup="filterContent()">
                <div style="margin-left: auto; font-size: 12px; color: #666;">[VOLTAR] para Sair</div>
            </div>

            <div class="content-body">
                <div class="sidebar">
                    <div class="menu-item focusable" onclick="filterCat('all')">Todos</div>
                    <div class="menu-item focusable" onclick="filterCat('sports')">Esportes</div>
                    <div class="menu-item focusable" onclick="filterCat('movies')">Cinema</div>
                    <div class="menu-item focusable" onclick="filterCat('kids')">Infantil</div>
                    <div class="menu-item focusable" onclick="backToHome()" style="color: var(--gold); margin-top: 20px;">‚¨Ö MENU INICIAL</div>
                </div>

                <div class="grid-container" id="content-grid">
                    </div>
            </div>
        </div>
    </section>

    <div id="player-overlay">
        <video id="video-player" controls></video>
    </div>

    <script>
        // --- VARI√ÅVEIS GLOBAIS ---
        var currentScreen = 'login'; 
        var focusElements = [];
        var focusIndex = 0;

        window.onload = function() {
            updateFocus();
            if(focusElements.length > 0) highlight(0);
        };

        // --- 1. LOGIN E DADOS DA CONTA ---
        function doLogin() {
            var user = document.getElementById('user').value;
            var pass = document.getElementById('pass').value;
            var server = document.getElementById('server').value;

            if(user && pass && server) {
                // Simula√ß√£o de resposta da API (Aqui voc√™ colocaria os dados reais)
                // PREENCHENDO AS INFORMA√á√ïES QUE VOC√ä PEDIU:
                document.getElementById('info-created').innerText = "01/01/2024"; // Data cria√ß√£o
                document.getElementById('info-expire').innerText = "01/01/2025";  // Data vencimento
                document.getElementById('info-limit').innerText = "1/3";          // Limite de telas

                // Transi√ß√£o
                document.getElementById('login-screen').style.display = 'none';
                document.getElementById('main-dashboard').style.display = 'flex';
                
                currentScreen = 'home';
                updateFocus();
                focusIndex = 0;
                highlight(0);
            } else {
                alert("Preencha todos os campos!");
            }
        }

        // --- 2. NAVEGA√á√ÉO DE CATEGORIAS ---
        function loadCategory(type) {
            document.getElementById('home-view').style.display = 'none';
            document.getElementById('list-view').style.display = 'flex';
            currentScreen = 'list';

            // Gerar canais falsos para teste (Limpeza e Organiza√ß√£o)
            var grid = document.getElementById('content-grid');
            grid.innerHTML = '';
            
            var channelNames = ["Globo SP", "SBT", "Record", "Band", "ESPN", "SportTV", "Telecine", "HBO", "Discovery", "Cartoon Network", "CNN Brasil", "Globo News", "Viva", "Multishow", "GNT"];
            
            // Cria 30 canais repetindo os nomes para testar scroll e busca
            for(var i=0; i<30; i++) {
                var name = channelNames[i % channelNames.length] + " " + (Math.floor(i/channelNames.length)+1);
                var div = document.createElement('div');
                div.className = 'card focusable';
                div.innerHTML = '<div style="font-size:30px;">üì∫</div><div class="card-name">'+name+'</div>';
                div.setAttribute('data-name', name.toLowerCase()); // Para busca r√°pida
                div.onclick = function() { openPlayer(); };
                grid.appendChild(div);
            }

            // Foca na busca primeiro
            setTimeout(function() {
                updateFocus();
                focusIndex = 0; // Index 0 agora √© a busca
                highlight(0);
            }, 100);
        }

        function backToHome() {
            document.getElementById('list-view').style.display = 'none';
            document.getElementById('home-view').style.display = 'flex';
            currentScreen = 'home';
            setTimeout(function() { updateFocus(); highlight(0); }, 100);
        }

        // --- 3. BUSCA OTIMIZADA ---
        function filterContent() {
            var term = document.getElementById('internal-search').value.toLowerCase().trim();
            var cards = document.querySelectorAll('#content-grid .card');
            
            for(var i=0; i<cards.length; i++) {
                var cardName = cards[i].getAttribute('data-name');
                if(cardName.indexOf(term) > -1) {
                    cards[i].style.display = 'flex';
                } else {
                    cards[i].style.display = 'none';
                }
            }
            // N√£o atualizamos o foco aqui para n√£o atrapalhar a digita√ß√£o
        }

        // --- 4. SISTEMA DE CONTROLE (Setas) ---
        function updateFocus() {
            var all = document.querySelectorAll('.focused');
            for(var i=0; i<all.length; i++) all[i].classList.remove('focused');

            if (currentScreen === 'login') {
                focusElements = document.querySelectorAll('#login-screen .focusable');
            } else if (currentScreen === 'home') {
                focusElements = document.querySelectorAll('#home-view .focusable');
            } else if (currentScreen === 'list') {
                // Ordem importante: Busca -> Sidebar -> Cards vis√≠veis
                // Seleciona apenas cards que N√ÉO est√£o escondidos (display: none)
                var visibleCards = [];
                var cards = document.querySelectorAll('#content-grid .card');
                for(var i=0; i<cards.length; i++) {
                    if(cards[i].style.display !== 'none') visibleCards.push(cards[i]);
                }
                
                var others = document.querySelectorAll('.search-container .focusable, .sidebar .focusable');
                focusElements = Array.prototype.slice.call(others).concat(Array.prototype.slice.call(visibleCards));
            }
        }

        function highlight(index) {
            if(!focusElements.length) return;
            if(focusElements[focusIndex]) focusElements[focusIndex].classList.remove('focused');

            if(index >= focusElements.length) index = 0;
            if(index < 0) index = focusElements.length - 1;

            focusIndex = index;
            focusElements[focusIndex].classList.add('focused');
            focusElements[focusIndex].focus();
            
            // Previne scroll da p√°gina inteira, faz scroll s√≥ do elemento se necess√°rio
            focusElements[focusIndex].scrollIntoView({block: "center", behavior: "smooth"});
        }

        document.addEventListener('keydown', function(e) {
            // Se estiver na busca e apertar Enter ou Baixo, atualiza lista de foc√°veis
            if(currentScreen === 'list' && e.key === 'ArrowDown') {
                 updateFocus(); // Atualiza para pegar os itens filtrados
            }

            switch(e.key) {
                case 'ArrowDown': highlight(focusIndex + 1); break;
                case 'ArrowUp': highlight(focusIndex - 1); break;
                case 'ArrowRight': highlight(focusIndex + 1); break;
                case 'ArrowLeft': highlight(focusIndex - 1); break;
                case 'Enter': 
                    if(focusElements[focusIndex]) focusElements[focusIndex].click(); 
                    break;
                case 'Backspace':
                case 'Escape':
                    if(currentScreen === 'list') backToHome();
                    if(currentScreen === 'player') closePlayer();
                    break;
            }
        });

        // --- 5. PLAYER ---
        function openPlayer() {
            document.getElementById('player-overlay').style.display = 'block';
            currentScreen = 'player';
            var video = document.getElementById('video-player');
            var url = "https://test-streams.mux.dev/x36xhzz/x36xhzz.m3u8"; // URL Teste

            if(Hls.isSupported()) {
                var hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(video);
                hls.on(Hls.Events.MANIFEST_PARSED,function() { video.play(); });
            } else {
                video.src = url;
                video.play();
            }
        }

        function closePlayer() {
            var video = document.getElementById('video-player');
            video.pause();
            document.getElementById('player-overlay').style.display = 'none';
            currentScreen = 'list';
            updateFocus();
        }

        setInterval(function() {
            var d = new Date();
            var h = d.getHours(); var m = d.getMinutes();
            if(h<10) h='0'+h; if(m<10) m='0'+m;
            document.getElementById('clock').innerText = h+':'+m;
        }, 1000);

    </script>
</body>
</html>
